<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="テキスト処理ツール - 文字解析、正規表現、エンコーディング変換、統計、整形、文字列変換、ハッシュ、差分比較、ランダム生成、CSV/TSV、マークダウン、フィルター、QRコード、分割/結合、ふりがな、テンプレート、文字頻度分析">
    <meta name="theme-color" content="#2196F3">
    <title>Text Toolbox</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/png" sizes="192x192" href="icon-192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="icon-512.png">
    <link rel="apple-touch-icon" href="icon-192.png">
</head>
<body>
    <div class="container">
        <header>
            <h1>📝 Text Toolbox</h1>
            <p class="subtitle">テキスト関連の便利ツール</p>
        </header>

        <main>
            <!-- 新しいツール切り替えナビゲーション -->
            <nav class="tool-switcher">
                <button class="tool-switcher-button" id="toolSwitcherBtn">
                    <span class="current-tool-name" id="currentToolName">🔢 文字解析</span>
                    <span class="dropdown-arrow">▼</span>
                </button>

                <!-- ドロップダウンメニュー -->
                <div class="tool-dropdown" id="toolDropdown">
                    <div class="dropdown-search">
                        <input type="text" id="toolSearch" placeholder="🔍 ツールを検索..." autocomplete="off">
                    </div>

                    <div class="dropdown-content" id="dropdownContent">
                        <!-- 📝 文字・コード -->
                        <div class="tool-category">
                            <div class="category-header">📝 文字・コード</div>
                            <button class="tool-item active" data-tab="char-analysis">🔢 文字解析</button>
                            <button class="tool-item" data-tab="encoding">🔄 エンコーディング</button>
                            <button class="tool-item" data-tab="frequency">📈 文字頻度</button>
                            <button class="tool-item" data-tab="furigana">🈯 ふりがな</button>
                        </div>

                        <!-- 🔍 検索・パターン -->
                        <div class="tool-category">
                            <div class="category-header">🔍 検索・パターン</div>
                            <button class="tool-item" data-tab="regex">🔍 正規表現</button>
                            <button class="tool-item" data-tab="filter">🔎 テキストフィルター</button>
                            <button class="tool-item" data-tab="diff">📝 差分比較</button>
                        </div>

                        <!-- ✨ 変換・整形 -->
                        <div class="tool-category">
                            <div class="category-header">✨ 変換・整形</div>
                            <button class="tool-item" data-tab="conversion">🔤 文字列変換</button>
                            <button class="tool-item" data-tab="formatting">✨ テキスト整形</button>
                            <button class="tool-item" data-tab="split">✂️ 分割/結合</button>
                        </div>

                        <!-- 📊 データ処理 -->
                        <div class="tool-category">
                            <div class="category-header">📊 データ処理</div>
                            <button class="tool-item" data-tab="csv">📊 CSV/TSV</button>
                            <button class="tool-item" data-tab="markdown">📄 マークダウン</button>
                            <button class="tool-item" data-tab="template">📋 テンプレート</button>
                        </div>

                        <!-- 📈 分析 -->
                        <div class="tool-category">
                            <div class="category-header">📈 分析</div>
                            <button class="tool-item" data-tab="statistics">📊 テキスト統計</button>
                        </div>

                        <!-- 🔐 セキュリティ -->
                        <div class="tool-category">
                            <div class="category-header">🔐 セキュリティ</div>
                            <button class="tool-item" data-tab="hash">🔐 ハッシュ</button>
                        </div>

                        <!-- 🎲 生成 -->
                        <div class="tool-category">
                            <div class="category-header">🎲 生成</div>
                            <button class="tool-item" data-tab="random">🎲 ランダム生成</button>
                            <button class="tool-item" data-tab="qrcode">📱 QRコード</button>
                        </div>
                    </div>
                </div>
            </nav>

            <!-- 文字コード表示ツール -->
            <section id="char-analysis" class="tool-section tab-content active">
                <h2>🔢 文字コード表示</h2>
                <div class="tool-content">
                    <div class="input-group">
                        <label for="charInput">テキストを入力してください:</label>
                        <textarea
                            id="charInput"
                            placeholder="文字を入力すると、文字コードが表示されます"
                            rows="4"
                        ></textarea>
                    </div>
                    <div id="charCodeOutput" class="output-area"></div>
                </div>
            </section>

            <!-- 正規表現チェッカー -->
            <section id="regex" class="tool-section tab-content">
                <h2>🔍 正規表現チェッカー</h2>
                <div class="tool-content">
                    <div class="input-group">
                        <label for="regexPattern">正規表現パターン:</label>
                        <input
                            type="text"
                            id="regexPattern"
                            placeholder="例: \d+|[a-z]+"
                        >
                        <div class="regex-flags">
                            <label>
                                <input type="checkbox" id="flagGlobal" checked> g (グローバル)
                            </label>
                            <label>
                                <input type="checkbox" id="flagIgnoreCase"> i (大文字小文字を区別しない)
                            </label>
                            <label>
                                <input type="checkbox" id="flagMultiline"> m (複数行)
                            </label>
                        </div>
                    </div>
                    <div class="input-group">
                        <label for="regexInput">テストする文字列:</label>
                        <textarea
                            id="regexInput"
                            placeholder="正規表現でテストする文字列を入力してください"
                            rows="4"
                        ></textarea>
                    </div>
                    <div id="regexOutput" class="output-area"></div>
                </div>
            </section>

            <!-- エンコーディング変換ツール -->
            <section id="encoding" class="tool-section tab-content">
                <h2>🔄 エンコーディング変換</h2>
                <div class="tool-content">
                    <div class="input-group">
                        <label for="encodingInput">テキストを入力してください:</label>
                        <textarea
                            id="encodingInput"
                            placeholder="エンコード/デコードするテキストを入力してください"
                            rows="4"
                        ></textarea>
                    </div>
                    <div class="button-group">
                        <button class="tool-button" onclick="encodeBase64()">Base64 エンコード</button>
                        <button class="tool-button" onclick="decodeBase64()">Base64 デコード</button>
                        <button class="tool-button" onclick="encodeURL()">URL エンコード</button>
                        <button class="tool-button" onclick="decodeURL()">URL デコード</button>
                        <button class="tool-button" onclick="encodeHTML()">HTML エンティティ</button>
                        <button class="tool-button" onclick="encodePunycode()">Punycode エンコード</button>
                        <button class="tool-button" onclick="decodePunycode()">Punycode デコード</button>
                    </div>
                    <div id="encodingOutput" class="output-area"></div>
                </div>
            </section>

            <!-- テキスト統計ツール -->
            <section id="statistics" class="tool-section tab-content">
                <h2>📊 テキスト統計・解析</h2>
                <div class="tool-content">
                    <div class="input-group">
                        <label for="statsInput">テキストを入力してください:</label>
                        <textarea
                            id="statsInput"
                            placeholder="統計を表示するテキストを入力してください"
                            rows="6"
                        ></textarea>
                    </div>
                    <div id="statsOutput" class="output-area"></div>
                </div>
            </section>

            <!-- テキスト整形ツール -->
            <section id="formatting" class="tool-section tab-content">
                <h2>✨ テキスト整形</h2>
                <div class="tool-content">
                    <div class="input-group">
                        <label for="formatInput">テキストを入力してください:</label>
                        <textarea
                            id="formatInput"
                            placeholder="整形するテキストを入力してください"
                            rows="6"
                        ></textarea>
                    </div>
                    <div class="button-group">
                        <button class="tool-button" onclick="formatJSON()">JSON 整形</button>
                        <button class="tool-button" onclick="minifyJSON()">JSON 最小化</button>
                        <button class="tool-button" onclick="sortLines()">行のソート (昇順)</button>
                        <button class="tool-button" onclick="sortLinesDesc()">行のソート (降順)</button>
                        <button class="tool-button" onclick="removeDuplicateLines()">重複行を削除</button>
                        <button class="tool-button" onclick="removeEmptyLines()">空行を削除</button>
                        <button class="tool-button" onclick="trimLines()">各行の空白を削除</button>
                        <button class="tool-button" onclick="convertToSpaces()">タブ→スペース (4)</button>
                        <button class="tool-button" onclick="convertToTabs()">スペース→タブ</button>
                    </div>
                    <div id="formatOutput" class="output-area"></div>
                </div>
            </section>

            <!-- 文字列変換ツール -->
            <section id="conversion" class="tool-section tab-content">
                <h2>🔤 文字列変換</h2>
                <div class="tool-content">
                    <div class="input-group">
                        <label for="conversionInput">テキストを入力してください:</label>
                        <textarea
                            id="conversionInput"
                            placeholder="変換するテキストを入力してください"
                            rows="4"
                        ></textarea>
                    </div>
                    <div class="button-group">
                        <button class="tool-button" onclick="toUpperCase()">大文字に変換</button>
                        <button class="tool-button" onclick="toLowerCase()">小文字に変換</button>
                        <button class="tool-button" onclick="toFullWidth()">全角に変換</button>
                        <button class="tool-button" onclick="toHalfWidth()">半角に変換</button>
                        <button class="tool-button" onclick="toHiragana()">ひらがなに変換</button>
                        <button class="tool-button" onclick="toKatakana()">カタカナに変換</button>
                        <button class="tool-button" onclick="toCamelCase()">キャメルケース</button>
                        <button class="tool-button" onclick="toSnakeCase()">スネークケース</button>
                        <button class="tool-button" onclick="toKebabCase()">ケバブケース</button>
                        <button class="tool-button" onclick="toPascalCase()">パスカルケース</button>
                    </div>
                    <div id="conversionOutput" class="output-area"></div>
                </div>
            </section>

            <!-- ハッシュ生成ツール -->
            <section id="hash" class="tool-section tab-content">
                <h2>🔐 ハッシュ生成</h2>
                <div class="tool-content">
                    <div class="input-group">
                        <label for="hashInput">テキストを入力してください:</label>
                        <textarea
                            id="hashInput"
                            placeholder="ハッシュを生成するテキストを入力してください"
                            rows="4"
                        ></textarea>
                    </div>
                    <div id="hashOutput" class="output-area"></div>
                </div>
            </section>

            <!-- 差分比較ツール -->
            <section id="diff" class="tool-section tab-content">
                <h2>📝 差分比較</h2>
                <div class="tool-content">
                    <div class="diff-container">
                        <div class="input-group">
                            <label for="diffInput1">テキスト1:</label>
                            <textarea
                                id="diffInput1"
                                placeholder="比較元のテキストを入力してください"
                                rows="6"
                            ></textarea>
                        </div>
                        <div class="input-group">
                            <label for="diffInput2">テキスト2:</label>
                            <textarea
                                id="diffInput2"
                                placeholder="比較先のテキストを入力してください"
                                rows="6"
                            ></textarea>
                        </div>
                    </div>
                    <div id="diffOutput" class="output-area"></div>
                </div>
            </section>

            <!-- ランダム生成ツール -->
            <section id="random" class="tool-section tab-content">
                <h2>🎲 ランダム生成</h2>
                <div class="tool-content">
                    <div class="random-controls">
                        <div class="input-group">
                            <label>パスワード生成:</label>
                            <div class="random-password-options">
                                <label>
                                    <input type="number" id="passwordLength" value="16" min="4" max="128">
                                    文字
                                </label>
                                <label>
                                    <input type="checkbox" id="includeUppercase" checked> 大文字
                                </label>
                                <label>
                                    <input type="checkbox" id="includeLowercase" checked> 小文字
                                </label>
                                <label>
                                    <input type="checkbox" id="includeNumbers" checked> 数字
                                </label>
                                <label>
                                    <input type="checkbox" id="includeSymbols"> 記号
                                </label>
                            </div>
                            <button class="tool-button" onclick="generatePassword()">パスワード生成</button>
                        </div>

                        <div class="input-group">
                            <label>UUID生成:</label>
                            <button class="tool-button" onclick="generateUUID()">UUID (v4) 生成</button>
                        </div>

                        <div class="input-group">
                            <label>Lorem Ipsum生成:</label>
                            <div class="lorem-options">
                                <label>
                                    <input type="number" id="loremParagraphs" value="3" min="1" max="20">
                                    パラグラフ
                                </label>
                            </div>
                            <button class="tool-button" onclick="generateLoremIpsum()">Lorem Ipsum 生成</button>
                        </div>
                    </div>
                    <div id="randomOutput" class="output-area"></div>
                </div>
            </section>

            <!-- CSV/TSVフォーマッター -->
            <section id="csv" class="tool-section tab-content">
                <h2>📊 CSV/TSVフォーマッター</h2>
                <div class="tool-content">
                    <div class="input-group">
                        <label for="csvInput">CSV/TSVデータを入力してください:</label>
                        <textarea
                            id="csvInput"
                            placeholder="例: name,age,city&#10;太郎,25,東京&#10;花子,30,大阪"
                            rows="6"
                        ></textarea>
                    </div>
                    <div class="input-group">
                        <label>区切り文字:</label>
                        <div class="csv-options">
                            <label>
                                <input type="radio" name="csvDelimiter" value="," checked> カンマ (,)
                            </label>
                            <label>
                                <input type="radio" name="csvDelimiter" value="\t"> タブ (\t)
                            </label>
                            <label>
                                <input type="checkbox" id="csvHasHeader" checked> ヘッダー行あり
                            </label>
                        </div>
                    </div>
                    <div class="button-group">
                        <button class="tool-button" onclick="csvToTable()">テーブル表示</button>
                        <button class="tool-button" onclick="csvToJSON()">JSON変換</button>
                        <button class="tool-button" onclick="csvToMarkdown()">Markdown Table変換</button>
                        <button class="tool-button" onclick="csvToTSV()">CSV ↔ TSV</button>
                        <button class="tool-button" onclick="csvSort()">ソート (第1列)</button>
                    </div>
                    <div id="csvOutput" class="output-area"></div>
                </div>
            </section>

            <!-- マークダウンプレビュー -->
            <section id="markdown" class="tool-section tab-content">
                <h2>📄 マークダウンプレビュー</h2>
                <div class="tool-content">
                    <div class="input-group">
                        <label for="markdownInput">マークダウンを入力してください:</label>
                        <textarea
                            id="markdownInput"
                            placeholder="# 見出し1&#10;## 見出し2&#10;**太字** *斜体*"
                            rows="8"
                        ></textarea>
                    </div>
                    <div class="button-group">
                        <button class="tool-button" onclick="markdownToHTML()">HTML変換</button>
                    </div>
                    <div id="markdownPreview" class="markdown-preview"></div>
                    <div id="markdownOutput" class="output-area"></div>
                </div>
            </section>

            <!-- テキストフィルター -->
            <section id="filter" class="tool-section tab-content">
                <h2>🔎 テキストフィルター</h2>
                <div class="tool-content">
                    <div class="input-group">
                        <label for="filterInput">テキストを入力してください:</label>
                        <textarea
                            id="filterInput"
                            placeholder="フィルタリングするテキストを入力してください"
                            rows="6"
                        ></textarea>
                    </div>
                    <div class="button-group">
                        <button class="tool-button" onclick="extractNumbers()">数字のみ抽出</button>
                        <button class="tool-button" onclick="extractAlpha()">英字のみ抽出</button>
                        <button class="tool-button" onclick="extractHiragana()">ひらがなのみ抽出</button>
                        <button class="tool-button" onclick="extractKatakana()">カタカナのみ抽出</button>
                        <button class="tool-button" onclick="extractKanji()">漢字のみ抽出</button>
                        <button class="tool-button" onclick="removeNumbers()">数字を削除</button>
                        <button class="tool-button" onclick="removeSymbols()">記号を削除</button>
                    </div>
                    <div class="input-group">
                        <label for="filterPattern">行フィルタリング (含む文字列):</label>
                        <input type="text" id="filterPattern" placeholder="例: エラー">
                        <button class="tool-button" onclick="filterLines()">行をフィルタリング</button>
                    </div>
                    <div id="filterOutput" class="output-area"></div>
                </div>
            </section>

            <!-- QRコード生成 -->
            <section id="qrcode" class="tool-section tab-content">
                <h2>📱 QRコード生成</h2>
                <div class="tool-content">
                    <div class="input-group">
                        <label for="qrInput">QRコードにするテキストを入力してください:</label>
                        <textarea
                            id="qrInput"
                            placeholder="URL、テキスト、メッセージなど"
                            rows="4"
                        ></textarea>
                    </div>
                    <div class="button-group">
                        <button class="tool-button" onclick="generateQRCode()">QRコード生成</button>
                    </div>
                    <div id="qrOutput" class="output-area qr-output"></div>
                </div>
            </section>

            <!-- テキスト分割/結合 -->
            <section id="split" class="tool-section tab-content">
                <h2>✂️ テキスト分割/結合</h2>
                <div class="tool-content">
                    <div class="input-group">
                        <label for="splitInput">テキストを入力してください:</label>
                        <textarea
                            id="splitInput"
                            placeholder="分割・結合するテキストを入力してください"
                            rows="6"
                        ></textarea>
                    </div>
                    <div class="input-group">
                        <label for="splitChars">文字数で分割:</label>
                        <div class="split-options">
                            <input type="number" id="splitChars" value="100" min="1" max="10000">
                            <button class="tool-button" onclick="splitByChars()">分割</button>
                        </div>
                    </div>
                    <div class="input-group">
                        <label for="splitDelimiter">区切り文字で分割:</label>
                        <div class="split-options">
                            <input type="text" id="splitDelimiter" placeholder="例: ,">
                            <button class="tool-button" onclick="splitByDelimiter()">分割</button>
                        </div>
                    </div>
                    <div class="input-group">
                        <label for="joinDelimiter">区切り文字で結合:</label>
                        <div class="split-options">
                            <input type="text" id="joinDelimiter" placeholder="例: , ">
                            <button class="tool-button" onclick="joinLines()">行を結合</button>
                        </div>
                    </div>
                    <div id="splitOutput" class="output-area"></div>
                </div>
            </section>

            <!-- ふりがな付与 -->
            <section id="furigana" class="tool-section tab-content">
                <h2>🈯 ふりがな付与</h2>
                <div class="tool-content">
                    <div class="input-group">
                        <label for="furiganaInput">日本語テキストを入力してください:</label>
                        <textarea
                            id="furiganaInput"
                            placeholder="漢字を含むテキストを入力してください"
                            rows="4"
                        ></textarea>
                    </div>
                    <div class="button-group">
                        <button class="tool-button" onclick="addFurigana()">ふりがな付与</button>
                        <button class="tool-button" onclick="generateRubyHTML()">Rubyタグ生成</button>
                    </div>
                    <div id="furiganaOutput" class="output-area"></div>
                    <div class="info-box">
                        <small>※ このツールは簡易的なふりがな付与です。辞書を使用していないため、読み仮名は参考程度にご利用ください。</small>
                    </div>
                </div>
            </section>

            <!-- テンプレート置換 -->
            <section id="template" class="tool-section tab-content">
                <h2>📋 テンプレート置換</h2>
                <div class="tool-content">
                    <div class="input-group">
                        <label for="templateInput">テンプレートを入力してください:</label>
                        <textarea
                            id="templateInput"
                            placeholder="例: こんにちは、{{name}}さん！{{message}}"
                            rows="6"
                        ></textarea>
                    </div>
                    <div class="input-group">
                        <label for="templateVars">変数 (JSON形式):</label>
                        <textarea
                            id="templateVars"
                            placeholder='例: {"name": "太郎", "message": "ようこそ"}'
                            rows="4"
                        ></textarea>
                    </div>
                    <div class="button-group">
                        <button class="tool-button" onclick="applyTemplate()">テンプレート適用</button>
                    </div>
                    <div id="templateOutput" class="output-area"></div>
                </div>
            </section>

            <!-- 文字頻度分析 -->
            <section id="frequency" class="tool-section tab-content">
                <h2>📈 文字頻度分析</h2>
                <div class="tool-content">
                    <div class="input-group">
                        <label for="frequencyInput">テキストを入力してください:</label>
                        <textarea
                            id="frequencyInput"
                            placeholder="頻度分析するテキストを入力してください"
                            rows="6"
                        ></textarea>
                    </div>
                    <div class="input-group">
                        <label>分析オプション:</label>
                        <div class="frequency-options">
                            <label>
                                <input type="radio" name="frequencyType" value="char" checked> 文字ごと
                            </label>
                            <label>
                                <input type="radio" name="frequencyType" value="word"> 単語ごと
                            </label>
                            <label>
                                <input type="number" id="frequencyTop" value="20" min="5" max="100">
                                件表示
                            </label>
                        </div>
                    </div>
                    <div class="button-group">
                        <button class="tool-button" onclick="analyzeFrequency()">頻度分析</button>
                    </div>
                    <div id="frequencyOutput" class="output-area"></div>
                </div>
            </section>
        </main>

        <footer>
            <p><a href="https://github.com/temeteke/text-toolbox" target="_blank" rel="noopener noreferrer">Text Toolbox</a></p>
        </footer>
    </div>

    <!-- 文字詳細ポップアップ -->
    <div id="charModal" class="modal">
        <div class="modal-content">
            <span class="modal-close">&times;</span>
            <div id="modalBody"></div>
        </div>
    </div>

    <script src="app.js"></script>
    <script>
        // Service Worker の登録
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js')
                    .then(reg => console.log('Service Worker registered'))
                    .catch(err => console.log('Service Worker registration failed:', err));
            });
        }
    </script>
</body>
</html>
